/* ========== FILE TREE ========== */
.file-tree {
  @apply rounded-2xl bg-card;
  corner-shape: squircle;
  box-shadow: var(--panel-ring);

  & summary {
    list-style: none;
    cursor: pointer;
    &::-webkit-details-marker { display: none; }
  }

  /* Root header */
  & > summary {
    @apply flex items-center justify-between rounded-2xl px-4 py-3 text-[14px] font-semibold text-foreground;
    transition: background-color 0.15s var(--apple-ease);
    &:hover { background: var(--surface-2); }
  }
  &[open] > summary { @apply rounded-b-none; }

  /* Tree body */
  & > div {
    @apply p-2;

    & summary {
      @apply flex items-center gap-1.5 rounded-lg px-2 py-1 text-[13px] text-foreground;
      transition: background-color 0.15s var(--apple-ease), color 0.15s var(--apple-ease);
      &:hover { background: var(--surface-2); }
      &:focus-visible { outline: 3px solid oklch(from var(--color-primary) l c h / 0.3); outline-offset: 2px; }
      & > svg { @apply size-4 shrink-0 text-muted-foreground; transition: color 0.15s var(--apple-ease); }
    }

    & .file-tree-chevron {
      @apply size-3.5 shrink-0 text-muted-foreground;
      transition: transform 0.2s var(--apple-spring);
    }
    & details[open] > summary > .file-tree-chevron {
      transform: rotate(90deg);
    }

    /* 20px per nesting level (Xcode-style) */
    & details > div { @apply pl-5; }
  }

  /* File item */
  & .file-tree-item {
    @apply flex cursor-pointer items-center gap-1.5 rounded-lg py-1 pr-2 text-[13px] text-foreground;
    padding-left: 1.75rem; /* aligns file icon with folder icon: px-2 + chevron + gap */
    transition: background-color 0.15s var(--apple-ease), color 0.15s var(--apple-ease);
    &:hover { background: var(--surface-2); }
    &:focus-visible { outline: 3px solid oklch(from var(--color-primary) l c h / 0.3); outline-offset: 2px; }
    & > svg { @apply size-4 shrink-0; }
    &[data-selected], &[aria-selected="true"] {
      @apply text-primary;
      background: oklch(from var(--color-primary) l c h / 0.18);
    }
  }

  /* Selected state for folder summary */
  & summary[data-selected], & summary[aria-selected="true"] {
    @apply text-primary;
    background: oklch(from var(--color-primary) l c h / 0.18);
  }
}
