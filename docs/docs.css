@import "tailwindcss";
@import "../src/css/ciderui.css";

/* ─── Docs Layout ─── */
@layer components {

  /* Sidebar */
  .docs-sidebar {
    @apply fixed left-0 top-0 z-40 h-screen w-[260px] overflow-y-auto border-r;
    background: oklch(from var(--color-background) l c h / 0.72);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
  }
  .docs-sidebar a {
    @apply flex items-center rounded-lg px-2 py-1.5 text-[13px] font-medium text-muted-foreground transition-colors duration-150;
    &:hover {
      @apply text-foreground;
      background: oklch(from var(--color-accent) l c h / 0.6);
    }
    &[data-active] {
      @apply text-primary;
      background: oklch(from var(--color-primary) l c h / 0.08);
    }
  }


  /* Main content area */
  .docs-main {
    @apply ml-[260px] min-h-screen;
  }

  .snippet-preview > figure {
    position: relative;
    & > .card, & > .field, & > table, & > .inline-alert, & > details, & > input, & > textarea, & > select, & > dialog, & > .input-group, & > .input-group-attached, & > .list-row, & > .list-section, & > form, & > fieldset, & > .command, & > .cider {
      @apply w-full;
    }
    & > .cider {
      max-width: none;
      padding-left: 0;
      padding-right: 0;
      margin: 0;
    }
    & pre {
      background: transparent;
      border-radius: 0;
    }
    &::after {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--color-muted-foreground);
      opacity: 0.5;
    }
  }
  .docs-copy-btn {
    @apply absolute right-3 top-3 rounded-md border px-2 py-1 text-[11px] font-medium transition-all duration-200 cursor-pointer;
    background: oklch(0.971 0.003 285.66 / 0.8);
    border-color: oklch(0.862 0.007 286.02);
    color: oklch(0.540 0.008 286.01);
    &:hover {
      background: oklch(0.920 0.003 285.66);
      color: oklch(0.232 0.004 285.99);
    }
    &:active {
      transform: scale(var(--apple-press-scale));
    }
  }
  :is(.dark) .docs-copy-btn {
    background: oklch(0.274 0.004 285.99 / 0.6);
    border-color: oklch(0.350 0.004 285.99);
    color: oklch(0.630 0.006 286.01);
    &:hover {
      background: oklch(0.350 0.004 285.99);
      color: oklch(0.971 0.003 285.66);
    }
  }

  /* Theme toggle */
  .docs-theme-toggle {
    @apply flex size-8 items-center justify-center rounded-lg text-muted-foreground transition-colors cursor-pointer;
    &:hover {
      @apply text-foreground;
      background: var(--color-accent);
    }
  }

  /* Mobile hamburger */
  .docs-hamburger {
    @apply hidden fixed top-4 left-4 z-50 size-9 items-center justify-center rounded-lg text-muted-foreground cursor-pointer border;
    background: oklch(from var(--color-background) l c h / 0.72);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border-color: var(--color-border);
    &:hover {
      @apply text-foreground;
      background: var(--color-accent);
    }
  }
  .docs-overlay {
    @apply fixed inset-0 z-30 hidden;
    background: oklch(0 0 0 / 0.4);
    backdrop-filter: blur(4px);
  }

  /* ─── Homepage ─── */
  .home-nav {
    @apply sticky top-0 z-50 border-b;
    background: oklch(from var(--color-background) l c h / 0.72);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
  }
  .home-showcase {
    @apply mx-auto px-6;
    max-width: 64rem;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }
  .home-showcase-row {
    display: grid;
    gap: 1.5rem;
  }
  .home-showcase-2 { grid-template-columns: repeat(2, 1fr); }
  .home-showcase-3 { grid-template-columns: repeat(3, 1fr); }
  .home-showcase-cell {
    display: flex;
    flex-direction: column;
    min-width: 0;
  }
  .home-showcase-card {
    @apply rounded-2xl border overflow-hidden;
    background: var(--color-card);
    padding: 1.5rem;
    flex: 1;
    box-shadow: 0 1px 3px rgb(0 0 0 / 0.02), 0 4px 16px rgb(0 0 0 / 0.03);
  }
  @media (max-width: 900px) {
    .home-showcase-3 {
      grid-template-columns: repeat(2, 1fr);
      & > :last-child:nth-child(odd) { grid-column: 1 / -1; }
    }
  }
  @media (max-width: 640px) {
    .home-hero { @apply py-12; }
    .home-showcase-2, .home-showcase-3 { grid-template-columns: 1fr; }
  }

  /* ========== SNIPPET (Code Block — docs only) ========== */
  .snippet {
    @apply rounded-[10px] border;
    corner-shape: squircle;
    & > :first-child {
      border-top-left-radius: calc(var(--radius) - 1px);
      border-top-right-radius: calc(var(--radius) - 1px);
    }
    & > :last-child {
      border-bottom-left-radius: calc(var(--radius) - 1px);
      border-bottom-right-radius: calc(var(--radius) - 1px);
    }
    & > pre {
      @apply overflow-x-auto p-4 m-0 text-[13px] leading-relaxed;
      background: var(--surface-2);
      & code, & code[class*="language-"], & code.hljs {
        @apply font-[ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace] text-[13px] font-normal p-0 rounded-none;
        background: transparent;
        color: var(--color-foreground);
      }
    }
    & > header {
      @apply flex items-center justify-between px-4 py-2 overflow-hidden;
      border-bottom: 1px solid var(--panel-border);
      background: var(--surface-2);
      & > span {
        @apply text-[12px] font-medium text-muted-foreground;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      }
      & > nav {
        @apply flex gap-0.5;
        & > button {
          @apply rounded-md px-2 py-1 text-[12px] font-medium text-muted-foreground;
          font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
          transition: all 0.15s var(--apple-ease);
          &:hover {
            @apply text-foreground;
            background: var(--surface-3);
          }
          &:focus-visible { outline: 2px solid var(--color-primary); outline-offset: 1px; }
          &[data-active] {
            @apply text-foreground;
            background: var(--surface-4);
          }
        }
      }
      & > button {
        @apply rounded-md border px-2 py-1 text-[12px] font-medium;
        background: var(--surface-2);
        border-color: var(--color-border);
        color: var(--color-muted-foreground);
        transition: all 0.15s var(--apple-ease);
        opacity: 0;
        &:hover {
          background: var(--surface-4);
          color: var(--color-foreground);
        }
        &:focus-visible { outline: 2px solid var(--color-primary); outline-offset: 1px; opacity: 1; }
        &:active {
          transform: scale(var(--apple-press-scale));
        }
      }
    }
    &:hover > header > button {
      opacity: 1;
    }
    & > .snippet-preview {
      border-bottom: 1px solid var(--panel-border);
      & > figure {
        @apply py-6 px-6 m-0;
      }
    }
    & > pre[data-panel]:not([data-active]) {
      @apply hidden;
    }
  }
  .snippet-lines {
    counter-reset: line;
    & .snippet-line {
      display: flex;
      &::before {
        counter-increment: line;
        content: counter(line);
        @apply inline-block shrink-0 text-right pr-4 text-muted-foreground/40 select-none;
        min-width: 2rem;
        font-variant-numeric: tabular-nums;
      }
    }
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .docs-sidebar {
      @apply -translate-x-full transition-transform duration-300;
    }
    .docs-sidebar.open {
      @apply translate-x-0;
    }
    .docs-overlay.open {
      @apply block;
    }
    .docs-main {
      @apply ml-0;
    }
    .docs-hamburger {
      @apply inline-flex;
    }
  }
}
